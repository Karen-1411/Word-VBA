Option Explicit

Sub memory()
    
CommandButton1.BackColor = RGB(204, 192, 218)
    
    '    late binding
    Dim objword As Object
    Set objword = CreateObject("Word.Application")
    
'Word模板
    Dim objdoc As Object
    
'儲存學生資料的worksheet
    Dim student As Worksheet

'宣告
    Dim bookmarkn, pathshape, named() As String
    Dim ccount, rcount, i, j As Integer

'計時開始
'    Dim start, final As Double
'
'    start = Timer
    
'初始化
    Set student = Sheets(1)
    pathshape = ThisWorkbook.Path
    named = Split(ThisWorkbook.Name, ".")   '儲存檔名(不包含副檔名)
    
    ccount = student.Cells(1, Columns.Count).End(xlToLeft).Column
    rcount = student.Cells(Rows.Count, 1).End(xlUp).Row
    
    For j = 2 To rcount Step 1

        Set objdoc = objword.documents.Open _
            (pathshape & "\" & named(0) & ".docm", ReadOnly:=True)
        
        For i = 2 To ccount Step 1
        
            bookmarkn = student.Cells(1, i).Value
            
            If objdoc.bookmarks.exists(bookmarkn) = True Then
                objdoc.bookmarks(bookmarkn).Range.Text = student.Cells(j, i).Value
            Else
                MsgBox "沒有"" & bookmarkn &  ""這個書籤喔！" & Chr(10) & "請到此資料夾中有巨集的word確認(有驚嘆號的) :)"
                Exit Sub
            End If
            
        Next
        
        objword.Run macroname:="forteacher"
    
    Next
    
    CommandButton1.BackColor = &HC0C0FF

'計時結束
'    final = Timer
'
'    MsgBox final - start
    
    Set objword = Nothing
    Set objdoc = Nothing
    
    Set student = Nothing

    

End Sub
